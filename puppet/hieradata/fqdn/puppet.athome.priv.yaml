---
enc_included_classes:
  - [ 'flaf', '::roles::puppetrouter' ]
enc_datacenter: 'vboxhome'
enc_groups: [ 'puppetserver' ]

network::params::ifaces:
  eth0:
    in_networks: [ 'freebox_lan' ]
    macaddress: '08:00:27:00:00:a0'
    inet:
      method: 'dhcp'
  eth1:
    in_networks: [ 'freebox_lan2' ]
    macaddress: '08:00:27:00:00:a1'
    inet:
      method: 'static'
      options:
        address: '10.0.0.1'
        netmask: '__default__'
        post-up_puppet_suffix_a: 'echo 1 > /proc/sys/net/ipv4/ip_forward'
        post-up_puppet_suffix_b: 'iptables -F && iptables -t nat -A POSTROUTING -s 10.0.0.0/8 -j MASQUERADE'
  eth2:
    in_networks: [ 'vbox_adm' ]
    macaddress: '08:00:27:00:00:a2'
    inet:
      method: 'static'
      options:
        address: '172.31.0.1'
        netmask: '__default__'
        post-up: 'iptables -t nat -A POSTROUTING -s 172.31.0.0/16 -j MASQUERADE'

pxeserver::params::host_records:
  - [ '%{::fqdn}',              '%{::hostname}', '172.31.0.1' ]
  - [ 'pxe.%{::domain}',        'pxe',           '172.31.0.1' ]
  - [ 'middleware.%{::domain}', 'middleware',    '172.31.0.2' ]

pxeserver::params::ip_reservations:
  '08:00:27:00:00:a3': [ '172.31.0.2', 'middleware' ]


