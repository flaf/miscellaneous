<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />

  <title>Class: network::interfaces</title>

  <link rel="stylesheet" href="../rdoc.css" type="text/css" media="screen" />

  <script src="../js/jquery.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/thickbox-compressed.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/quicksearch.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/darkfish.js" type="text/javascript" charset="utf-8"></script>

</head>
<body id="top" class="class">

  <div id="metadata">
    <div id="home-metadata">
      <div id="home-section" class="section">
        <h3 class="section-header">
          <a href="../index.html">Home</a>
          <a href="../index.html#classes">Classes</a>
          <a href="../index.html#methods">Methods</a>
        </h3>
      </div>
    </div>

    <div id="file-metadata">
      <div id="file-list-section" class="section">
        <h3 class="section-header">In Files</h3>
        <div class="section-body">
          <ul>
          
            <li><a href="..//usr/local/src/git/miscellaneous/puppet/production/modules/network/manifests/interfaces_pp.html?TB_iframe=true&amp;height=550&amp;width=785"
              class="thickbox" title="/usr/local/src/git/miscellaneous/puppet/production/modules/network/manifests/interfaces.pp">/usr/local/src/git/miscellaneous/puppet/production/modules/network/manifests/interfaces.pp</a></li>
          
          </ul>
        </div>
      </div>

      
    </div>

    <div id="class-metadata">
      
      <!-- Parent Class -->
      <div id="parent-class-section" class="section">
        <h3 class="section-header">Parent</h3>
        
        <p class="link"></p>
        
      </div>
      

      

      

      

      
    </div>

    <div id="project-metadata">
      
      
      <div id="fileindex-section" class="section project-section">
        <h3 class="section-header">Files</h3>
        <ul>
        
          <li class="file"><a href="..//usr/local/src/git/miscellaneous/puppet/production/modules/apt/Gemfile.html">Gemfile</a></li>
        
          <li class="file"><a href="..//usr/local/src/git/miscellaneous/puppet/production/modules/apt/LICENSE.html">LICENSE</a></li>
        
          <li class="file"><a href="..//usr/local/src/git/miscellaneous/puppet/production/modules/apt/Rakefile.html">Rakefile</a></li>
        
          <li class="file"><a href="..//usr/local/src/git/miscellaneous/puppet/production/modules/stdlib/Gemfile.html">Gemfile</a></li>
        
          <li class="file"><a href="..//usr/local/src/git/miscellaneous/puppet/production/modules/stdlib/LICENSE.html">LICENSE</a></li>
        
          <li class="file"><a href="..//usr/local/src/git/miscellaneous/puppet/production/modules/stdlib/Rakefile.html">Rakefile</a></li>
        
        </ul>
      </div>
      

      <div id="classindex-section" class="section project-section">
        <h3 class="section-header">Class/Module Index
          <span class="search-toggle"><img src="../images/find.png"
            height="16" width="16" alt="[+]"
            title="show/hide quicksearch" /></span></h3>
        <form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
        <fieldset>
          <legend>Quicksearch</legend>
          <input type="text" name="quicksearch" value=""
            class="quicksearch-field" />
        </fieldset>
        </form>

        <ul class="link-list">
        
          <li><a href="../profiles.html">profiles</a></li>
        
          <li><a href="../profiles/apt.html">profiles::apt</a></li>
        
          <li><a href="../profiles/apt/ceph.html">profiles::apt::ceph</a></li>
        
          <li><a href="../profiles/apt/standard.html">profiles::apt::standard</a></li>
        
          <li><a href="../profiles/ceph.html">profiles::ceph</a></li>
        
          <li><a href="../profiles/ceph/cluster.html">profiles::ceph::cluster</a></li>
        
          <li><a href="../profiles/grub.html">profiles::grub</a></li>
        
          <li><a href="../profiles/grub/standard.html">profiles::grub::standard</a></li>
        
          <li><a href="../profiles/hosts.html">profiles::hosts</a></li>
        
          <li><a href="../profiles/hosts/ceph.html">profiles::hosts::ceph</a></li>
        
          <li><a href="../profiles/hosts/params.html">profiles::hosts::params</a></li>
        
          <li><a href="../profiles/hosts/standard.html">profiles::hosts::standard</a></li>
        
          <li><a href="../profiles/keyboard.html">profiles::keyboard</a></li>
        
          <li><a href="../profiles/keyboard/standard.html">profiles::keyboard::standard</a></li>
        
          <li><a href="../profiles/locales.html">profiles::locales</a></li>
        
          <li><a href="../profiles/locales/standard.html">profiles::locales::standard</a></li>
        
          <li><a href="../profiles/misc.html">profiles::misc</a></li>
        
          <li><a href="../profiles/misc/standard.html">profiles::misc::standard</a></li>
        
          <li><a href="../profiles/network.html">profiles::network</a></li>
        
          <li><a href="../profiles/network/standard.html">profiles::network::standard</a></li>
        
          <li><a href="../profiles/ntp.html">profiles::ntp</a></li>
        
          <li><a href="../profiles/ntp/standard.html">profiles::ntp::standard</a></li>
        
          <li><a href="../profiles/puppet.html">profiles::puppet</a></li>
        
          <li><a href="../profiles/puppet/standard.html">profiles::puppet::standard</a></li>
        
          <li><a href="../profiles/ssh.html">profiles::ssh</a></li>
        
          <li><a href="../profiles/ssh/standard.html">profiles::ssh::standard</a></li>
        
          <li><a href="../profiles/timezone.html">profiles::timezone</a></li>
        
          <li><a href="../profiles/timezone/standard.html">profiles::timezone::standard</a></li>
        
          <li><a href="../apt.html">apt</a></li>
        
          <li><a href="../apt/__facts__.html">apt::__facts__</a></li>
        
          <li><a href="../apt/__types__.html">apt::__types__</a></li>
        
          <li><a href="../apt/apt.html">apt::apt</a></li>
        
          <li><a href="../apt/backports.html">apt::backports</a></li>
        
          <li><a href="../apt/debian.html">apt::debian</a></li>
        
          <li><a href="../apt/debian/testing.html">apt::debian::testing</a></li>
        
          <li><a href="../apt/debian/unstable.html">apt::debian::unstable</a></li>
        
          <li><a href="../apt/params.html">apt::params</a></li>
        
          <li><a href="../apt/release.html">apt::release</a></li>
        
          <li><a href="../apt/unattended_upgrades.html">apt::unattended_upgrades</a></li>
        
          <li><a href="../apt/update.html">apt::update</a></li>
        
          <li><a href="../stdlib.html">stdlib</a></li>
        
          <li><a href="../stdlib/__facts__.html">stdlib::__facts__</a></li>
        
          <li><a href="../stdlib/__functions__.html">stdlib::__functions__</a></li>
        
          <li><a href="../stdlib/__types__.html">stdlib::__types__</a></li>
        
          <li><a href="../stdlib/stages.html">stdlib::stages</a></li>
        
          <li><a href="../stdlib/stdlib.html">stdlib::stdlib</a></li>
        
          <li><a href="../roles.html">roles</a></li>
        
          <li><a href="../roles/ceph_cluster.html">roles::ceph_cluster</a></li>
        
          <li><a href="../roles/nothing.html">roles::nothing</a></li>
        
          <li><a href="../roles/standard.html">roles::standard</a></li>
        
          <li><a href="../roles/standard_without_hosts.html">roles::standard_without_hosts</a></li>
        
          <li><a href="../network.html">network</a></li>
        
          <li><a href="../network/__functions__.html">network::__functions__</a></li>
        
          <li><a href="../network/hosts.html">network::hosts</a></li>
        
          <li><a href="../network/interfaces.html">network::interfaces</a></li>
        
          <li><a href="../ceph.html">ceph</a></li>
        
          <li><a href="../ceph/ceph.html">ceph::ceph</a></li>
        
          <li><a href="../ceph/packages.html">ceph::packages</a></li>
        
          <li><a href="../ssh.html">ssh</a></li>
        
          <li><a href="../ssh/client.html">ssh::client</a></li>
        
          <li><a href="../ssh/server.html">ssh::server</a></li>
        
          <li><a href="../bash.html">bash</a></li>
        
          <li><a href="../bash/bash.html">bash::bash</a></li>
        
          <li><a href="../grub.html">grub</a></li>
        
          <li><a href="../grub/grub.html">grub::grub</a></li>
        
          <li><a href="../keyboard.html">keyboard</a></li>
        
          <li><a href="../keyboard/keyboard.html">keyboard::keyboard</a></li>
        
          <li><a href="../locales.html">locales</a></li>
        
          <li><a href="../locales/locales.html">locales::locales</a></li>
        
          <li><a href="../ntp.html">ntp</a></li>
        
          <li><a href="../ntp/ntp.html">ntp::ntp</a></li>
        
          <li><a href="../puppet.html">puppet</a></li>
        
          <li><a href="../puppet/client.html">puppet::client</a></li>
        
          <li><a href="../repository.html">repository</a></li>
        
          <li><a href="../repository/ceph.html">repository::ceph</a></li>
        
          <li><a href="../timezone.html">timezone</a></li>
        
          <li><a href="../timezone/timezone.html">timezone::timezone</a></li>
        
          <li><a href="../vim.html">vim</a></li>
        
          <li><a href="../vim/vim.html">vim::vim</a></li>
        
          <li><a href="../__site__.html">__site__</a></li>
        
          <li><a href="../eval_ruby_code.html">eval_ruby_code</a></li>
        
        </ul>
        <div id="no-class-search-results" style="display: none;">No matching classes.</div>
      </div>

      
    </div>
  </div>

  <div id="documentation">
    <h1 class="class">network::interfaces</h1>

    <div id="description" class="description">
      
<p>Puppet class to primarily manage the /etc/network/interfaces file.</p>

<h2>Requirement/Dependencies</h2>

<p>Depends on Puppetlabs-stdlib.</p>

<h2>Parameters</h2>

<p><b>rename_interfaces</b>: Boolean to choose if you want to rename the
interfaces. If true, the class will manage a udev rule with a file in the
/etc/udev/rules.d/ directory. If true, to be effective, you must apply MAC
addresses of the interfaces (see the "interfaces" parameter below) because
the rule is a mapping "MAC address" to "interface name". The default value
of this parameter is false.</p>

<p><b>restart_network</b>: Boolean to choose if you want to restart the
network after the configuration update. In fact, the class doesn't really
manage the /etc/network/interfaces file but the
/etc/network/interfaces.puppet file. So, after the configuration update, if
you don't restart the network, changes are not realized. if the parameter
is set to true, after any change of the configuration, the whole network is
restarted automatically and the change will be realized. Be careful, it
could be dangerous to set this parameter to true for servers in production
environment because the least configuration change will cause the restart
of the whole network and if your new configuration is buggy... BANG!!! The
default value of this parameter is false (more secure).</p>

<p><b>interfaces</b>: This parameter is mandatory and has no default value.
This parameter is a hash with this form:</p>

<pre>{
 'eth0' =&gt; {
             'macaddress' =&gt; '08:00:27:bc:cf:03',
             'method'     =&gt; 'static',
             'address'    =&gt; '172.31.20.6',
             'netmask'    =&gt; '255.255.0.0',
             'dns-search  =&gt; [ '@domain', 'toto.com', ],
           },
 'eth1' =&gt; {
             'macaddress' =&gt; '08:00:27:bc:cf:04',
             'method'     =&gt; 'dhcp',
             'comment'    =&gt; 'Blabla',
           },
}</pre>

<p>For each interface, the "method" property is mandatory. If the method is
"static" the "address" and "netmask" properties are mandatory. The value of
a property can be an array of strings. In this case, the value is updated
to value.join(' '). If a value is a string with this form '@xxxx', it's
automatically replaced by the @xxxx fact.</p>

<p>There are some properties, the meta options, which are just put in
comments. Here is the list of these meta options:</p>

<pre>meta_options = [
                'macaddress',
                'network_name',
                'vlan_name',
                'vlan_id',
                'cidr_address',
                'comment',
               ]</pre>

<h2>Useful public functions</h2>

<h3>complete_ifaces_hash($ifaces, $inventoried_networks)</h3>

<p>The function returns an updated version of $ifaces with the informations
inside $inventoried_networks which must contain the "cidr_address". Here is
an example:</p>

<pre>$interfaces = {
 'eth0' =&gt; {
             'macaddress'     =&gt; '08:00:27:bc:cf:03',
             'method'         =&gt; 'static',
             'address'        =&gt; '172.31.20.6/16',
             'gateway'        =&gt; '&lt;default&gt;',
             'dns-nameservers =&gt; '&lt;default&gt;',
           },
}

$inventoried_networks = {
  'private' =&gt; {
                 'cidr_address'    =&gt; '172.31.0.0/16',
                 'gateway'         =&gt; '172.31.0.1',
                 'dns-nameservers' =&gt; [ '172.31.0.2', '172.31.0.3', ],
                 'vlan_id'         =&gt; '0'
                 'ntp_servers      =&gt; [ '172.31.0.1', ]
               }
  'public'  =&gt; {
                 'cidr_address'    =&gt; '192.168.0.0/24',
                 'gateway'         =&gt; '192.168.0.1',
                 'dns-nameservers' =&gt; [ '192.168.0.1', ],
                 'vlan_id'         =&gt; '1'
                 'ntp_servers      =&gt; [ '192.168.0.1', ]
               }

$new_ifaces = complete_ifaces_hash($ifaces, $inventoried_networks)</pre>

<p>In this example, the function use the CIDR address of eth0 to find the
matching network. Then, each value equal to '&lt;default&gt;' will be
replaced by the value in the matching network. Note: with an interface with
a CIDR address, the "netmask", "network" and "broadcast" properties will be
automatically appended. It's possible to don't use a CIDR address for an
interface, but if you want to help the function to find a matching network,
you must use the "network_name" property in the interface ('public' or
'private' in the example above).</p>

<h3>get_network_name($ipaddr, $netmask, $inventoried_networks)</h3>

<p>Returns the name of the network which matches with the $ipaddr and
$netmask. Here is an example:</p>

<pre># Same value as the example above.
$inventoried_networks = ...

$network_name = get_network_name($ipaddr, $netmask, $inventoried_networks)

# Now, we can retrieve the list of the ntp servers
# in the current network.
$ntp_servers = $inventoried_networks[$network_name]</pre>

    </div><!-- description -->

    
    
    
    <div id="5Buntitled-5D" class="documentation-section">
      

      

      

      

      <!-- Methods -->
      
    </div><!-- 5Buntitled-5D -->
  

  </div><!-- documentation -->

  <div id="validator-badges">
    <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
    <p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
      Rdoc Generator</a> 2</small>.</p>
  </div>

</body>
</html>

