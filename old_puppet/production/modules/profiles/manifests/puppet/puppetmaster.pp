class profiles::puppet::puppetmaster {

$server_private_key = '-----BEGIN RSA PRIVATE KEY-----
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
-----END RSA PRIVATE KEY-----
'
$server_public_key = '-----BEGIN PUBLIC KEY-----
MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAn9iZ8f3beLlRATAlgDEF
qiuhQvX1wIMhEj96JoCB4DMPKUNy6aF6nB52IvN/lCq5pc7Au38jC7W47s5EiUiJ
L3l53w9shjG25WXN+voZwYhofJ+nnKp1uUdhd6wve0d0Dj8eWSi8ES4ntDHAzsx5
ULk1jWaIdeG3ZYegCgwPSGckRsGkeB/LWee0aQWLyG80dxzM8CZpJIFvQZvx7HAU
/8yAicQKTh+ZxRvWWbjxPjpsoDGFl7opLZfEbXkdWg6m+m70X3mtW5Jxij6HW6VF
pcb3qLNOb2cwbGIvsSd1NBDVY8XLYwJF70/ihJJyr4+lOWwt1AsBg/iHSiyor33+
YjS2A1CRYdGYO4k+oFej1QnuuGVxt2Zf/rR4o0ROG47ymHR/KTISUBl7+31jpkVL
xoe8lhqKCAaj/5IPMVM6mhIpJq9EFb3PEDfL3pg7FoxHISnCqMl6DksQ83iJ2HG7
IUuFhY/Je3OFvJVJ0mH7yTFLyg0lf7IIAZjRVYZobuKTU/gKt3Z3XVbKQMJHK9Ao
ov6YE/jpNY/Slh1Ef5Eaxh3my0ZDK3ewpZmAywtfp99z7xHJ2vNU3tYOcpluYYYr
zfal4dUTGV4qu1cFS9s1WFZsvanSqtHRuE4X0jtvvh4Qj3EnS1p6o4ey/+s6jgpO
DIFLpt+crz4FqPlxzgr+KPECAwEAAQ==
-----END PUBLIC KEY-----
'

$client_public_key = '-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDNjYApDFtAgX59sfHzEzmKAk5L
4TxuJ5nQmEIY4VyZHP93NlMAjbGnPSFVysumQiChgA/UAXklw1aSUuvH8QLuftse
BIlO6GbUhyA4PbPDS6KROZD/ZfjzCdwiq8AQNCnCdCFiwOTTCNigmQGiJvOg7k/M
0aOURad3g25ZAAgL6QIDAQAB
-----END PUBLIC KEY-----
'

$client_private_key = '-----BEGIN RSA PRIVATE KEY-----
MIICXQIBAAKBgQDNjYApDFtAgX59sfHzEzmKAk5L4TxuJ5nQmEIY4VyZHP93NlMA
jbGnPSFVysumQiChgA/UAXklw1aSUuvH8QLuftseBIlO6GbUhyA4PbPDS6KROZD/
ZfjzCdwiq8AQNCnCdCFiwOTTCNigmQGiJvOg7k/M0aOURad3g25ZAAgL6QIDAQAB
AoGAVMzEi6qyVrlVkst/kpVizoHHBVzljlg+B6VY12TZy7z/05GQypCqMuFwSDGC
tJNhXN81KHR3I1Ij+/fDl9fhKf+mZYCr40S0ZRYPQ1ReGhjg/IbG0qlpAsMDflxY
qlHgtRnTIEBMNwHR2DJMFO/ra1ZDXtJTp2vWIGfjgY140QUCQQDwZmfHHcvbCNyH
6gUqJn6A6Yc1KbYOlHjqkLGE8lwMNZgTPdhHzq1wz1BKQja9a/+l/upv+G0yZh4D
ecBJwswXAkEA2uQzvB+yuuFw4IVfGVU/ppI+KZoXIK/Cbti/Fp8hnceUG7W0Ad+k
q55gUUhcQM1pFJefaeRm0AOkHIvjvZrn/wJAa2DCb/0OJlrx7j+IaQhirwAgZY2p
BSAqVlOlB0Yd+VIjCE0ygvh9HgtryI+E1d0chq+zVao4VC+qrlC+o/O/pwJBAI6F
DQZNIUM6rBMT48KL1gCvsZfGw449wfwIVgr1m56upsmP+l9J7V7spMvnsGFlHSkS
O/Jni2WfKUiI8MSwSqMCQQDF/K/8ts91NGy7tqnOX7SDzFs00GGe4PQwBi3geGYZ
S5tnhz0W2fa/okSzsJ2hqZN0VpfwQh4QStKex5DYRXx0
-----END RSA PRIVATE KEY-----
'


  if $::fqdn == 'puppet.athome.priv'  {

    class { '::puppetmaster':
      puppet_server        => '<myself>',
      ca_server            => '<myself>',
      module_repository    => '<puppetforge>',
      environment_timeout  => '0s',
      puppetdb_server      => '<myself>',
      puppetdb_dbname      => 'puppetdb',
      puppetdb_user        => 'puppetdb',
      puppetdb_pwd         => md5($::fqdn),
      generate_eyaml_keys  => true,
      admin_email          => undef,
      hiera_git_repository => 'git@github.com:flaf/test-hiera.git',
    }

  }

  if $::fqdn == 'subpuppet-1.athome.priv'  {

    class { '::mcollective::middleware':
      puppet_ssl_dir => '/var/lib/puppet/sslclient',
    }

    class { '::mcollective::server':
      server_private_key => $server_private_key,
      server_public_key  => $server_public_key,
      middleware_server  => 'subpuppet-1.athome.priv',
      middleware_port    => '61614',
      mcollective_pwd    => '6fc8f528c63b71d8421c53f2f13c311f',
      ssl_dir            => '/var/lib/puppet/sslclient',
      client_public_keys => {
                               'subpuppet-1.athome.priv' => { 'content' => $client_public_key, },
                             },
    }

    class { '::mcollective::client':
      server_public_key  => $server_public_key,
      client_private_key => $client_private_key,
      client_public_key  => $client_public_key,
      middleware_server  => 'subpuppet-1.athome.priv',
      middleware_port    => '61614',
      mcollective_pwd    => '6fc8f528c63b71d8421c53f2f13c311f',
      ssl_dir            => '/var/lib/puppet/sslclient',
    }

    class { '::puppetmaster':
      puppet_server        => 'puppet.athome.priv',
      ca_server            => 'puppet.athome.priv',
      module_repository    => '<puppetforge>',
      environment_timeout  => '0s',
      puppetdb_server      => 'puppet.athome.priv',
      puppetdb_dbname      => 'puppetdb',
      puppetdb_user        => 'puppetdb',
      puppetdb_pwd         => md5($::fqdn),
      generate_eyaml_keys  => false,
      admin_email          => undef,
      hiera_git_repository => '<none>',
    }

  }

}


